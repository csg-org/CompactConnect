# Jurisdiction Onboarding for Compact Connect

Before a jurisdiction (i.e. state) can be onboarded to the Compact Connect system, there is certain information that 
must be provided for that jurisdiction. This document outlines the information that is required and how that information
is to be defined in the system. The following steps must be taken to onboard a jurisdiction to the Compact Connect system:

1. Decide Jurisdiction Fee for a Compact Privilege
2. Determine Contact Details for System Notifications
3. Ensure Jurisdiction License Names and Adverse Actions are compatible with System
4. Determine Jurisprudence Requirements
5. Determine Active Development Environments for Jurisdiction
6. Add Jurisdiction Configuration File to the System
7. Add Global Compact Configuration File to the System

## Deciding Jurisdiction Fee for a Compact Privilege
The first step in onboarding a jurisdiction to the Compact Connect system is to decide on the fee that the jurisdiction
will charge for a compact privilege. The value must be defined as part of the configuration file under the following field.
```
jurisdictionFee: number
```

### Decide Military Discount
The jurisdiction must also decide if they will offer a military discount for military affiliated licensees. 
If they choose to do so, that discount amount must be defined.
```
militaryDiscount:  
    discountType: "FLAT_RATE" 
    active: true 
    discountAmount: <number>
```

## Determine Contact Details for System Notifications
The jurisdiction must provide contact details for the following notifications:

1. Operations Team Notifications
2. Adverse Actions Notifications
3. Summary Report Notifications

The following subsections detail the information that must be provided for each notification.

### Operations Team Notifications
The jurisdiction must provide an email address for the operations team that will be responsible for handling support 
notifications. This can include notifications for invalid data that a jurisdiction has uploaded, or any other issues that
may arise. 

NOTE: While the system supports multiple email addresses, jurisdictions should be encouraged to utilize a distribution 
list that end users can subscribe to. This gives them the ability to add or remove users from the list as needed 
without requiring a change to the configuration file.

The email addresses must be defined as part of the configuration file under the following field.
```
jurisdictionOperationsTeamEmails: ["<email address>"]
```

### Adverse Actions Notifications
The jurisdiction must provide an email address for the adverse actions team that will be responsible for handling notifications
related to adverse actions. This can include notifications for licensees that have had their licenses revoked or suspended.

NOTE: While the system supports multiple email addresses, jurisdictions should be encouraged to utilize a distribution 
list that end users can subscribe to. This gives them the ability to add or remove users from the list as needed 
without requiring a change to the configuration file.

The email address must be defined as part of the configuration file under the following field.
```
jurisdictionAdverseActionsNotificationEmails: ["<email address>"]
```

### Summary Report Notifications
The jurisdiction must provide an email address for receiving summary reports that will be generated by the system periodically.

NOTE: While the system supports multiple email addresses, jurisdictions should be encouraged to utilize a distribution 
list that end users can subscribe to. This gives them the ability to add or remove users from the list as needed 
without requiring a change to the configuration file.

This email address must be defined as part of the configuration file under the following field.
```
jurisdictionSummaryReportNotificationEmails: ["<email address>"]
```

## Ensure Jurisdiction License Names and Adverse Actions are compatible with System

### Translate License Names
Each compact supports a specific set of license types, as defined under the `license_types` field in the `cdk.json` file.
As part of onboarding, the jurisdiction is responsible for translating their license names to correlate with the names
defined for the compact.

### Translate Adverse Actions
In addition to license names, jurisdictions will be responsible for this translating their jurisdiction specific 
adverse action types for system recognized types. Currently, these have yet to be defined, but will be in the future.
TODO - define adverse action types

## Determine Jurisprudence Requirements
The jurisdiction must notify the commission as to whether or not there are jurisprudence requirements for licensees 
in a jurisdiction (i.e. an assessment of an individual's knowledge of the laws and rules governing the practice of the
medical field related to that license). If jurisprudence requirements exist, this must be defined as part of the 
configuration file under the following field.
```
jurisprudenceRequirements: 
    required: true
```


## Determine Active Development Environments for Jurisdiction
When a jurisdiction is first being onboarded to the system, they may only want to be active in certain development 
environments.
As if this time of writing, the following environment names are supported:
```
sandbox, test, prod
```

In order for a jurisdiction to be active in a specific environment, you must define the list of environments that the 
configuration should be deployed to under the following required field.
```
activeEnvironments: ["sandbox", "test"]
```

## Add Jurisdiction Configuration File to the System
Once all of the above information has been gathered, the jurisdiction configuration file must be added for the 
specific compact in a YAML format, see https://yaml.org/spec/1.2.2/. These files are stored in the `compact-config` 
subdirectory under the `compact-connect` directory. The file system structure is as follows:
```
compact-connect
│
└───compact-config
    │   <compact-name>.yml
    │   
    └───<compact-name ie aslp>
        │   <jurisdiction-name>.yml
        │   <jurisdiction-name>.yml
```

The jurisdiction configuration file name must be the name of the jurisdiction with '-' characters in place of spaces. 
The file must be defined in the following format (unless otherwise noted, all fields are required):
```
jurisdictionName: "<jurisdiction name>"
postalAbbreviation: "<jurisdiction abbreviation>"
jurisdictionFee: <number>
militaryDiscount:  
    active: true | false
    discountType: "FLAT_RATE" 
    discountAmount: <number>
jurisdictionOperationsTeamEmails: ["<email address>"]
jurisdictionAdverseActionsNotificationEmails: ["<email address>"]
jurisdictionSummaryReportNotificationEmails: ["<email address>"]
jurisprudenceRequirements: 
    required: true | false
activeEnvironments: ["sandbox", "test"]
```

## Add Global Compact Configuration File to the System
In addition to the jurisdiction configuration files, if a new compact is being added, a global compact configuration 
file must be added to the root of the `compact-config` directory. If it is not present for an associated directory of 
the same name, the deployment will fail. The compact file includes the following information (unless otherwise noted,
all fields are required).
```
compactName: "<compact name>"
compactCommissionFee:
    feeType: "FLAT_RATE"
    feeAmount: <number>
compactOperationsTeamEmails: ["<email address>"]
compactAdverseActionsNotificationEmails: ["<email address>"]
compactSummaryReportNotificationEmails: ["<email address>"]
activeEnvironments: ["sandbox", "test"]
```
At deploy time, if the environment name matches one of the files in the `activeEnvironments` list, these configuration
files will be written to the database and accessible by the system.
