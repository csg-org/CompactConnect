# State Onboarding for Compact Connect

Before a state can be onboarded to the Compact Connect system, there is certain information that must be provided for
that state. This document outlines the information that is required and how that information is to be defined in the
system. The following steps must be taken to onboard a state to the Compact Connect system:

1. Decide State Fee for a Compact Privilege
2. Determine Contact Details for System Notifications
3. Ensure State License Names and Adverse Actions are compatible with System
4. Determine Jurisprudence Requirements
5. Determine Active Development Environments for State
6. Add State Configuration File to the System

## Deciding State Fee for a Compact Privilege
The first step in onboarding a state to the Compact Connect system is to decide on the fee that the state will 
charge for a compact privilege. The value must be defined as part of the configuration file under the following field.
```
stateFee: number
```

### Decide Military Discount
The state must also decide if they will offer a military discount for military affiliated licensees. 
If they choose to do so, that discount amount must be defined.
```
militaryDiscount:  
    discountType: "FLAT_RATE" 
    active: true 
    discountAmount: <number>
```

## Determine Contact Details for System Notifications
The state must provide contact details for the following notifications:

1. Operations Team Notifications
2. Adverse Actions Notifications
3. Summary Report Notifications

The following subsections detail the information that must be provided for each notification.

### Operations Team Notifications
The state must provide an email address for the operations team that will be responsible for handling support 
notifications. This can include notifications for invalid data that a state has uploaded, or any other issues that
may arise. The email address must be defined as part of the configuration file under the following field.
```
stateOperationsTeamEmail: "<email address>"
```

### Adverse Actions Notifications
The state must provide an email address for the adverse actions team that will be responsible for handling notifications
related to adverse actions. This can include notifications for licensees that have had their licenses revoked or suspended.
The email address must be defined as part of the configuration file under the following field.
```
stateAdverseActionsNotificationEmail: "<email address>"
```

### Summary Report Notifications
The state must provide an email address for receiving summary reports that will be generated by the system periodically.
This email address must be defined as part of the configuration file under the following field.
```
stateSummaryReportNotificationEmail: "<email address>"
```

## Ensure State License Names and Adverse Actions are compatible with System

### Translate License Names
Each compact supports a specific set of license types, as defined under the `license_types` field in the `cdk.json` file.
As part of onboarding, the state is responsible for translating their license names to correlate with the names defined for the compact.

### Translate Adverse Actions
In addition to license names, states will be responsible for this translating their state specific adverse action types
for system recognized types. Currently, these have yet to be defined, but will be in the future.
TODO - define adverse action types

## Determine Jurisprudence Requirements
The state must notify the commission as to whether or not there are jurisprudence requirements for licensees in a state
(i.e. an assessment of an individual's knowledge of the laws and rules governing the practice of the medical field 
related to that license). If jurisprudence requirements exist, this must be defined as part of the configuration file under the following field.
```
jurisprudenceRequirements: 
    required: true
```


## Determine Active Development Environments for State
When a state is first being onboarded to the system, they may only want to be active in certain development environments.
As if this time of writing, the following environment names are supported:
```
sandbox, test, prod
```

In order for a state to be active in a specific environment, you must define the list of environments that the 
configuration should be deployed to under the following required field.
```
activeEnvironments: ["sandbox", "test"]
```

## Add State Configuration File to the System
Once all of the above information has been gathered, the state configuration file must be added for the specific compact.
These files are stored in the `compact-config` subdirectory under the `compact-connect` directory. 
The file system structure is as follows:
```
compact-connect
│
└───compact-config
    │   <compact-name>.yaml
    │   
    └───<compact-name ie aslp>
        │   <state-name>.yaml
        │   <state-name>.yaml
```

The state configuration file name must be the name of the state with '-' characters in place of spaces. 
The file must be defined in the following format (unless otherwise noted, all fields are required):
```
stateName: "<state name>"
stateFee: <number>
militaryDiscount:  
    active: true | false
    discountType: "FLAT_RATE" 
    discountAmount: <number>
stateOperationsTeamEmail: "<email address>"
stateAdverseActionsNotificationEmail: "<email address>"
stateSummaryReportNotificationEmail: "<email address>"
jurisprudenceRequirements: 
    required: true | false
activeEnvironments: ["sandbox", "test"]
```

In addition to the state configuration file, if a new compact is being added, a global compact configuration file must
be added to the root of the `compact-config` directory. If it is not present for an associated directory of the same
name, the deployment will fail. The compact file includes the following information 
(unless otherwise noted, all fields are required).
```
compactName: "<compact name>"
compactFees:
    feeType: "FLAT_RATE"
    feeAmount: <number>
compactOperationsTeamEmail: "<email address>"
compactAdverseActionsNotificationEmail: "<email address>"
compactSummaryReportNotificationEmail: "<email address>"
activeEnvironments: ["sandbox", "test"]
```
At deploy time, if the environment name matches one of the files in the `activeEnvironments` list, these configuration
files will be written to the database and accessible by the system.
